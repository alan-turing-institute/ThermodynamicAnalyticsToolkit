[[reference_simulation_harmonic_oscillator]]
Examples
--------
We show how to set up some basic models, which can be a useful tool
to study and test methods.

[[reference_simulation_harmonic_oscillator.harmonic_oscillator]]
Harmonic oscillator
~~~~~~~~~~~~~~~~~~~

It can be sometimes useful to use TATi to simulate simple harmonic oscillator.
This model can be obtained by training neural network with one parameter
on one point latexmath:[X=1] in dimension one with label
equal to zero, i.e. latexmath:[Y=0], and using mean square loss function and
linear activation function.
More precisely, the cost function
becomes in this setting:

latexmath:[L(\omega | X,Y) = | \omega X + b - Y|^2],

where we fix the bias latexmath:[b=0].


- Dataset:
+
---------------
from TATi.common import data_numpy_to_csv
import numpy as np

X = np.asarray([[1]])
Y = np.asarray([[0]])

# prepare and save the trivial data set for later
datasetName = 'dataset_ho.csv'
data_numpy_to_csv(X, Y, datasetName)
numberOfPoints = 1
---------------
- Setup and train neural network:
+
----------------
import TATi.simulation as tati

nn = tati(
    batch_data_files=[datasetName],
    batch_size=numberOfPoints,
    dropout=None,
    fix_parameters="output/biases/Variable:0=0.",
    output_dimension=1,
    input_dimension=1,
    output_activation = "linear",
    inverse_temperature=1.0,
    loss="mean_squared",
    max_steps=10000,
    sampler="BAOAB",
    seed=426,
    step_width=0.5,
    friction_constant=1000.0,
    trajectory_file="trajectory_ho.csv",
    verbose=1
)

run_info, trajectory, averages = nn.sample()

df_trajectories = pd.DataFrame(trajectory)
# sampled trajectory
weight0 = np.asarray(df_trajectories['weight0']
----------------

- Sampled trajectory:
+
The output trajectory is distributed w.r.t. to a Gaussian, i.e. the density
of X:=weight0 is latexmath:[exp(-X^2)], see Figure link:#reference_simulation_harmonic_oscillator.harmonic_oscillator[Gaussian distribution].


[reference_simulation_harmonic_oscillator.harmonic_oscillator[density]]
.Gaussian distribution. Histogram of the trajectories obtained by simulating 1D harmonic oscillator with BAOAB sampler.
image::pictures/density_harmonic_oscillator.png[alt="runtime comparison",{basebackend@docbook:scaledwidth="40%":width=400}]

[reference_simulation_harmonic_oscillator.blobs]]
Blobs
~~~~~

[reference_simulation_harmonic_oscillator.mnist]]
MNIST
~~~~~
